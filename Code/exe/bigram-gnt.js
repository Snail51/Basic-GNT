// MINIFIED VERSION OF THE FILE OF THE SAME NAME IN THE `src` FOLDER
// MINIFIED WITH https://www.toptal.com/developers/javascript-minifier
// MINIFIED AT Sat Apr 19 17:08:14 CDT 2025

import{Reader as t}from"./reader.js";import{Provider as r}from"./provider.js";export class GNT{constructor(){this.corpusReader=new t("corpus"),this.corpus=[],this.vocab=[],this.counts=[]}async exe(){await this.buildcorpus(),await this.buildVocabulary(),await this.buildProbability()}async buildcorpus(){this.corpus=[];var t=await this.corpusReader.readSingleAsText();for(var r of t=(t=(t=(t=(t=(t=(t=t.data).replace(/[\t\n]/g," . ")).replace(/\s/g," ")).replace(/\./g," . ")).replace(/[^a-zA-Z0-9 \.]/g,"")).toLowerCase()).split(" "))""!=r&&this.corpus.push(r)}async buildVocabulary(){for(var t of(this.vocab=[],this.corpus))r(t,this.vocab)||this.vocab.push(t);function r(t,r){for(var s of r)if(s==t)return!0;return!1}}word2id(t){for(var r=0;r<this.vocab.length;r++)if(this.vocab[r]==t)return r;return -1}async buildProbability(){this.counts=[],this.counts=Array(this.vocab.length).fill().map(()=>Array(this.vocab.length).fill(0)),console.log(this.counts);for(var t=0;t<this.corpus.length-1;t++){var r=this.word2id(this.corpus[t]),s=this.word2id(this.corpus[t+1]);this.counts[r][s]=this.counts[r][s]+1}for(var o of(this.rows=[],this.counts)){var i=0;for(var a of o)i+=a;this.rows.push(i)}this.prob=[],this.prob=Array(this.vocab.length).fill().map(()=>Array(this.vocab.length).fill(0));for(var e=0;e<this.vocab.length;e++)for(var h=0;h<this.vocab.length;h++)this.prob[e][h]=this.counts[e][h]/this.rows[e];alert("ready for synthesis")}get_next_word(t){var r=this.prob[this.word2id(t)],s=this.vocab,o=Math.random(),i=0;for(let a=0;a<r.length;a++)if((i+=r[a])>o)return s[a]}generate_text(t,r){var s=[];s.push(t);for(var o=0;o<r;o++){var i=this.get_next_word(s[s.length-1]);s.push(i)}document.getElementById("output").innerHTML+="";var a="";for(var e of s)a+=" "+e;a=(a=a.replace(/[\.\ ]*\.[\.\ ]*/g,".\n")).replace(/\ s\ /g,"'s "),document.getElementById("output").value=a}}